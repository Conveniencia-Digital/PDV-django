{% block style %}
<style>
/* Linha principal */
.venda-row {
    transition: background 0.2s ease, box-shadow 0.2s ease;
}
.venda-row:hover {
    background: #f8f9fa;
}

/* Cabeçalho fake (mais leve) */
.venda-header th {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: #6c757d;
    border: none;
}

/* Status */
.badge-status {
    padding: 6px 10px;
    border-radius: 999px;
    font-size: 0.75rem;
}
.status-entregue {
    background: #e6f4ea;
    color: #1e7e34;
}
.status-outro {
    background: #e9ecef;
    color: #495057;
}

/* Ações */
.acoes a {
    margin-left: 10px;
    color: #6c757d;
    transition: transform 0.15s ease, color 0.15s ease;
}
.acoes a:hover {
    transform: translateY(-2px);
    color: #0d6efd;
}

/* Collapse */
.toggle-detalhes i {
    transition: transform 0.3s ease;
}
.toggle-detalhes[aria-expanded="true"] i {
    transform: rotate(180deg);
}

/* Detalhes */
.detalhes-box {
    background: #f9fafb;
    border-radius: 10px;
    padding: 15px;
}

/* Tabela interna */
.detalhes-box table th {
    font-size: 0.75rem;
    text-transform: uppercase;
    color: #6c757d;
    border-bottom: 1px solid #dee2e6;
}
.detalhes-box table td {
    vertical-align: middle;
}

</style>
{% endblock %}


<!-- Linha principal da venda -->

<tr class="venda-header">
    <th>Data</th>
    <th>Cliente</th>
    <th>Status</th>
    <th class="text-end">Ações</th>
</tr>


<tr id="venda-{{ object.pk }}" class="venda-row">
    <td>
        <strong>{{ object.data_criacao|date:'d/m/Y' }}</strong><br>
        <small class="text-muted">{{ object.data_criacao|date:'H:i:s' }}</small>
    </td>

    <td>
        <strong>{{ object.cliente.nome_cliente }}</strong><br>
        <a href="tel:+55{{ object.cliente.telefone_contato }}"
           class="text-muted text-decoration-none">
            {{ object.cliente.telefone_contato }}
        </a>
    </td>

    <td>
        {% if object.status == 'Entregue' %}
            <span class="badge-status status-entregue">{{ object.status }}</span>
        {% else %}
            <span class="badge-status status-outro">{{ object.status }}</span>
        {% endif %}
    </td>

    <td class="acoes text-end">
        <a hx-get="{% url 'detalhe-vendas' object.pk %}"
           data-bs-toggle="modal"
           data-bs-target="#staticBackdrop"
           hx-target="#addConteudo"
           title="Imprimir">
            <i class="fa-solid fa-print"></i>
        </a>

        <a hx-get="{% url 'editar-vendas' object.pk %}"
           data-bs-toggle="modal"
           data-bs-target="#staticBackdrop"
           hx-target="#addConteudo"
           title="Editar">
            <i class="fa-solid fa-pen-to-square"></i>
        </a>

        <a hx-get="{% url 'relatorio-lucro' object.pk %}"
           data-bs-toggle="modal"
           data-bs-target="#staticBackdrop"
           hx-target="#addConteudo"
           title="Lucro">
            <i class="fa-solid fa-chart-simple"></i>
        </a>

        <a class="toggle-detalhes"
           data-bs-toggle="collapse"
           href="#detalhes-{{ object.pk }}"
           aria-expanded="false"
           title="Detalhes">
            <i class="fa-solid fa-chevron-down"></i>
        </a>
    </td>
</tr>


<!-- Detalhes da venda -->
<tr class="collapse" id="detalhes-{{ object.pk }}">
    <td colspan="4">
        <div class="detalhes-box">
            <table class="table table-sm mb-0">
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Qtd</th>
                        <th>Preço</th>
                        <th class="text-end">Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    {% for items in object.vendas_items.all %}
                    <tr>
                        <td>{{ items.produto }}</td>
                        <td>{{ items.quantidade }}</td>
                        <td>{{ items.preco }}</td>
                        <td class="text-end">{{ items.subtotal }}</td>
                    </tr>
                    {% endfor %}

                    <tr class="text-danger">
                        <td colspan="2"></td>
                        <th>Total sem desconto</th>
                        <th class="text-end">{{ object.total_sem_desconto }}</th>
                    </tr>
                    <tr class="text-danger">
                        <td colspan="2"></td>
                        <th>Desconto</th>
                        <th class="text-end">{{ object.desconto }}</th>
                    </tr>

                    <tr class="text-success">
                        <th>Pagamento</th>
                        <td>{{ object.forma_pagamento }}</td>
                        <th>Total</th>
                        <th class="text-end">{{ object.total }}</th>
                    </tr>
                </tbody>
            </table>
        </div>
    </td>
</tr>
